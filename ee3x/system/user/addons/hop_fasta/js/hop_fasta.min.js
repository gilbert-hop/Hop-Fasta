$(document).ready(function(){window.location.href.indexOf("design/template")>-1&&($(".wrap form[action*='design/template/edit']").addClass("fasta"),$("form.fasta .form-ctrls, form.fasta .form-btns").not(".form-btns-top").prepend('<button id="fasta_update" class="btn" value="update" data-submit-text="Quick Update" data-work-text="Saving...">Quick Update</button><span id="fasta_status" style="display:none;"></span>'),$("#fasta_update").click(function(){var a=$(this);a.attr("disabled","disabled"),a.addClass("work"),a.html(a.data("work-text"));var t={};$.each($("form.fasta").serializeArray(),function(a,e){t.hasOwnProperty(e.name)?(t[e.name]=$.makeArray(t[e.name]),t[e.name].push(e.value)):t[e.name]=e.value});if(window.location.href.indexOf("design/template")>-1){if(void 0===$("form.fasta textarea[name='template_data']").data("codemirror.editor")||0==$("form.fasta textarea[name='template_data']").data("codemirror.editor"))e=$("form.fasta textarea[name='template_data']").val();else var e=$("form.fasta textarea[name='template_data']").data("codemirror.editor").getValue();t.template_data=e}return $.ajax({type:"POST",url:$("form.fasta").attr("action"),data:t,dataType:"json",success:function(t){a.html(a.data("submit-text")),a.removeAttr("disabled"),a.removeClass("work"),$("#fasta_status").html(" OK").show().delay(800).fadeOut()},error:function(t){a.html(a.data("submit-text")),a.removeAttr("disabled"),a.removeClass("work"),$("#fasta_status").html("Failed").show().delay(1200).fadeOut()}}),!1}),$("form.fasta").on("submit",function(a){var t=$("#fasta_update");t.attr("disabled","disabled"),t.addClass("work"),t.html(t.data("work-text"))}))});